<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">
	
	<!-- URL mapping to Controller -->
	<bean id="coreUrlMapping"
		class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="mappings">
			<props>
				<prop key="/admin/lookup.jspx">systemCodesController</prop>	
				<prop key="/admin/people.jspx">userController</prop>
				<prop key="/login.jspx">coreViewMapController</prop>
				<prop key="/denied.jspx">coreViewMapController</prop>	
				<prop key="/request-password-reset.jspx">requestPasswordReset</prop>		
				<prop key="/confirm-password-reset.jspx">confirmPasswordReset</prop>
				<prop key="/change-password.jspx">changePassword</prop>
				<prop key="/in1tializ3R.jspx">initializer</prop>
				<prop key="/admin/usergroup.jspx">userGroupController</prop>
			</props>
		</property>
	</bean>
	
	<!-- Generic view mapping to load initial pages -->
	<bean id="coreViewMapController" class="com.ideyatech.core.controller.ViewMapController">
		<property name="viewMap">
		<map>
			<entry key="login.jspx" value="acegi-login" />
			<entry key="denied.jspx" value="access-denied" />
		</map>
		</property>
		<property name="defaultView" value="index"/>
	</bean>

	<!-- Controllers -->
	<bean id="initializer" class="com.ideyatech.core.controller.InitializeController" autowire="byName">
		<property name="messageView" value="user-message"/>
	</bean>
	
	<bean id="userController"
		class="com.ideyatech.core.controller.UserController">
		<property name="service" ref="userService"/>		
		<property name="userGroupService" ref="userGroupService"/>
		<property name="commandName" value="user" />
		<property name="commandClass" value="com.ideyatech.core.bean.user.BaseUser" />
		<property name="formView" value="core/user/user-form" />
		<property name="searchView" value="core/user/users" />
		<property name="refreshView" value="core/user/user-refresh" />
		<!-- 
		<property name="validator">
			<ref bean="userValidator" />
		</property>
		 -->
		<property name="pageSize" value="${search.page.size}" />
		<property name="numLinks" value="${search.links.displayed}" />	
	</bean>
	
	<bean id="systemCodesController"
		class="com.ideyatech.core.controller.SystemCodesController">
		<property name="service" ref="systemCodesService"/>
		<property name="category" ref="systemCategory"/>
		<property name="commandName" value="systemCode" />
		<property name="commandClass" value="com.ideyatech.core.bean.SystemCodes" />
		<property name="formView" value="core/systemcode/systemcode-form" />
		<property name="searchView" value="core/systemcode/systemcodes" />
		<property name="refreshView" value="core/systemcode/systemcode-refresh" />
		<property name="validator">
			<ref bean="systemCodesValidator" />
		</property>
		<property name="pageSize" value="${search.page.size}" />
		<property name="numLinks" value="${search.links.displayed}" />	
	</bean>
	
	<bean id="requestPasswordReset" autowire="byName"
		class="com.ideyatech.core.controller.RequestPasswordResetController">
		<property name="commandName" value="passwordReset" />
		<property name="commandClass" value="com.ideyatech.core.bean.PasswordReset" />
		<property name="formView" value="forgot-password" />
		<property name="successView" value="user-message"/>
		<property name="validator" ref="requestPasswordResetValidator"/>
	</bean>
	
	<bean id="confirmPasswordReset" autowire="byName"
		class="com.ideyatech.core.controller.ConfirmPasswordResetController">
		<property name="commandName" value="passwordReset" />
		<property name="commandClass" value="com.ideyatech.core.bean.PasswordReset" />
		<property name="formView" value="forgot-password" />
		<property name="successView" value="forgot-password"/>
		<property name="validator" ref="confirmPasswordResetValidator"/>
	</bean>
	
	<bean id="changePassword" autowire="byName"
		class="com.ideyatech.core.controller.ChangePasswordController">
		<property name="commandName" value="passwordReset" />
		<property name="commandClass" value="com.ideyatech.core.bean.PasswordReset" />
		<property name="formView" value="forgot-password" />
		<property name="successView" value="user-message"/>
		<property name="validator" ref="changePasswordValidator"/>
	</bean>
	
	<bean id="userGroupController"
		class="com.ideyatech.core.controller.UserGroupController">
		<property name="service" ref="userGroupService"/>
		<property name="commandName" value="userGroup" />
		<property name="commandClass" value="com.ideyatech.core.bean.user.UserGroup" />
		<property name="formView" value="core/usergroup/usergroup-form" />
		<property name="searchView" value="core/usergroup/usergroups" />
		<property name="refreshView" value="core/usergroup/usergroup-refresh" />
		<property name="pageSize" value="${search.page.size}" />
		<property name="numLinks" value="${search.links.displayed}" />	
	</bean>
	
	<!-- Validators -->
	<bean id="systemCodesValidator"
		class="com.ideyatech.core.validator.SystemCodesValidator" />
	<bean id="requestPasswordResetValidator" autowire="byName"
		class="com.ideyatech.core.validator.RequestPasswordResetValidator"/>
	<bean id="confirmPasswordResetValidator" autowire="byName"
		class="com.ideyatech.core.validator.ConfirmPasswordResetValidator"/>
	<bean id="changePasswordValidator" autowire="byName"
		class="com.ideyatech.core.validator.ChangePasswordValidator"/>
		
	<!-- multipart resolver -->
	<bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver"/>
	
</beans>